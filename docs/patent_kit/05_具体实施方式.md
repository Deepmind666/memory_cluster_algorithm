# 05 具体实施方式

## 实施例一：冲突保真模式（推荐）
- 场景：planner/writer/verifier 共同写入专利草稿记忆池。
- 设置：`keep_conflicts=true`，`category_strength.method=strong`。
- 行为：同主题碎片被聚类；参数冲突（如 alpha=0.2/0.7）被显式记录。
- 结果：避免冲突值静默覆盖，检索时可定位双方证据。

## 实施例二：层次压缩模式
- 场景：长周期项目，簇数量持续增长。
- 设置：启用二级簇聚类，形成主题树。
- 行为：上层摘要用于快速路由，下层 backrefs 保留细节。
- 结果：降低全量扫描耗时，提高查询吞吐。

## 实施例三：偏好保留模式
- 场景：噪声日志与关键证据混合写入。
- 设置：`noise=discardable`，`verifier_agent` 权重提升。
- 行为：日志碎片降级压缩，证据碎片保留较高细节预算。
- 结果：在相同容量下提升关键信息保真度。

## 实施细节补充
- 可采用 JSONL 或 SQLite 存储。
- 向量化实现可替换，不限制具体模型。
- 阈值 `T_sim`、`T_merge` 可由离线评估集标定。

## 实施例四：冲突证据图 + 自适应预算 + 双通道门控
- 场景：多 Agent 并行更新参数建议，语义高度相似但槽位值冲突频发。
- 设置：
  - `enable_conflict_graph=true`
  - `enable_adaptive_budget=true`
  - `enable_dual_merge_guard=true`
- 行为：
  - 对冲突槽位生成证据图，计算冲突优先级与值切换次数；
  - 对高冲突高熵簇自动分配更高摘要预算；
  - 对语义接近但槽位冲突不兼容的簇阻断合并。
- 技术效果：
  - 降低错误合并率；
  - 提升冲突可解释性；
  - 在固定预算约束下提高关键证据保真度。

## 实施例四量化结果（对应 R-009 / R-010）

数据来源：
- `outputs/ablation_metrics.json`
- `outputs/prune_benchmark.json`

关键结果：
1. CEG 相比 baseline：
- `top1_conflict_priority_gain = +8.8`
- `conflict_priority_avg_gain = +8.8`

2. ARB 相比 baseline：
- `detail_budget_avg_gain = +68.0`
- `avg_summary_chars_gain = +209.0`

3. DMG 相比 baseline：
- `mixed_mode_clusters_reduction = 1`
- `merge_block_gain = +4`

4. Merge Upper-Bound Prune（merge_active_case）：
- `baseline avg_ms = 13.949`
- `prune on avg_ms = 13.610`
- `avg_speedup_ratio = 0.024303`
- `merge_activity_present = true`

说明：
- FULL 组合场景并非在所有数据集上都压低压缩率，存在“更高可解释性/证据保真”与“更强压缩率”之间的可配置 trade-off。

## 实施例五：候选筛选与 ANN 混合门控（R-017）

数据来源：
- `outputs/candidate_filter_benchmark.json`
- `outputs/ann_hybrid_benchmark.json`

关键结果：
1. Candidate Filter（`merge_active_case`）：
- `avg_speedup_ratio = 0.160152`
- `attempt_reduction_ratio = 0.373366`
- `cluster_count_equal = true`

2. ANN Prune（`merge_active_case`）：
- `avg_speedup_ratio = -0.160874`
- `quality_gate_pass = true`

3. Hybrid Prune（`merge_active_case`）：
- `avg_speedup_ratio = -0.179044`
- `quality_gate_pass = true`

实施结论：
- 在当前实现与参数下，Candidate Filter + Prune 为推荐默认路径；
- ANN 混合门控在 active 场景存在负加速，保留为实验性开关并继续调优。

## 实施例六：冲突语义精度回归（R-016）

数据来源：
- `outputs/semantic_regression_metrics.json`
- `docs/eval/semantic_regression_report.md`

关键结果：
- `case_count = 8`
- `case_pass_rate = 1.0`
- `expected_hit_rate = 1.0`
- `forbidden_violations = 0`

说明：
- 本回归集覆盖条件后件隔离、双重否定窗口、英文/中文跨句代词回指等关键语义边界；
- 用于支撑冲突记录语义可靠性，不直接改变默认压缩策略。
