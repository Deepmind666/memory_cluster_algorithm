# 06 权利要求书草案

## 独立权利要求

### 权利要求1（方法）
一种多 Agent 协同下的语义记忆碎片聚类压缩方法，其特征在于，包括：
1. 获取多个代理写入的记忆碎片，所述记忆碎片至少包括内容字段、来源代理标识、时间戳、标签和来源追溯信息；
2. 对所述记忆碎片进行语义向量化，并基于相似度阈值执行增量聚类，将新碎片归入已有簇或创建新簇；
3. 对每一语义簇执行结构化融合，提取共识字段并检测同槽位多值冲突；
4. 对检测到的冲突生成冲突记录结构，所述冲突记录至少包括槽位、候选值集合和证据引用；
5. 读取记忆保留偏好向量，按照类别偏好、来源偏好和时效偏好确定簇级保留强度与压缩预算；
6. 基于所述保留强度生成簇摘要，并保存从簇摘要指向原始碎片的可逆回溯索引；
7. 在检索阶段先输出簇摘要，再依据回溯索引按需展开原始碎片证据。

### 权利要求2（系统）
一种多 Agent 语义记忆治理系统，其特征在于，包括：
- 碎片采集模块；
- 向量化模块；
- 增量聚类模块；
- 冲突标记模块；
- 偏好策略模块；
- 存储索引模块；
- 检索展开模块；
其中各模块协同执行权利要求1所述方法步骤。

### 权利要求3（存储介质）
一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行时实现权利要求1所述方法。

## 从属权利要求

### 权利要求4
根据权利要求1所述方法，其中所述记忆碎片类型至少包括：对话片段、工具输出、中间结论、评测结果和日志信息。

### 权利要求5
根据权利要求1所述方法，其中增量聚类在归属判断时同时使用语义相似度约束和标签兼容约束。

### 权利要求6
根据权利要求1所述方法，其中所述冲突记录进一步包括最近观测时间字段。

### 权利要求7
根据权利要求1所述方法，其中来源偏好通过代理可信权重控制对应碎片在压缩中的保留概率或保留等级。

### 权利要求8
根据权利要求1所述方法，其中时效偏好用于在超过时效阈值后将簇内容降级至低细节摘要层。

### 权利要求9
根据权利要求1所述方法，其中可逆回溯索引至少包括簇标识到原始碎片标识集合的映射关系。

### 权利要求10
根据权利要求1所述方法，其中检索阶段采用“簇级粗召回 + backrefs 细展开”两阶段策略。

### 权利要求11
根据权利要求2所述系统，其中存储索引模块采用版本化写入策略，以支持历史摘要版本追踪。

### 权利要求12
根据权利要求2所述系统，其中冲突标记模块支持在检测到高风险冲突时触发验证代理补充证据。

### 权利要求13
根据权利要求3所述存储介质，其中程序执行后输出至少包括压缩比、冲突簇率和检索耗时指标。

### 权利要求14
根据权利要求1所述方法，其中在检测到同槽位多值冲突后，构建冲突证据图，所述冲突证据图至少包括：冲突值节点、冲突值切换边、冲突优先级以及主导值。

### 权利要求15
根据权利要求1所述方法，其中簇摘要预算由自适应预算函数生成，所述函数至少基于冲突密度、来源分布熵和时效衰减因子联合计算。

### 权利要求16
根据权利要求1所述方法，其中在簇合并阶段采用语义相似度通道与冲突兼容通道的双通道门控，只有当两个通道均满足阈值条件时才允许合并。

### 权利要求17
根据权利要求1所述方法，其中在簇合并阶段进一步对候选簇对执行相似度上界估计，当候选簇对的理论相似度上界低于合并阈值时跳过完整相似度计算，并记录被剪枝的候选簇对数量。
