<svg xmlns="http://www.w3.org/2000/svg" width="1700" height="980" viewBox="0 0 1700 980">
  <defs>
    <style><![CDATA[
      .title { font: 700 32px "Microsoft YaHei", "PingFang SC", sans-serif; fill: #10243e; }
      .entity { fill: #f7fbff; stroke: #1d3f66; stroke-width: 2.3; }
      .entity2 { fill: #fffaf2; stroke: #9a6a1f; stroke-width: 2.3; }
      .name { font: 700 22px "Microsoft YaHei", "PingFang SC", sans-serif; fill: #10243e; }
      .field { font: 500 17px "Microsoft YaHei", "PingFang SC", sans-serif; fill: #173a60; }
      .edge { stroke: #1d3f66; stroke-width: 2.6; fill: none; }
      .edgeD { stroke: #3f6793; stroke-width: 2.6; fill: none; stroke-dasharray: 9 8; }
      .card { font: 600 18px "Microsoft YaHei", "PingFang SC", sans-serif; fill: #1d3f66; }
    ]]></style>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="9" markerHeight="9" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#1d3f66"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1700" height="980" fill="#ffffff"/>
  <text x="850" y="58" text-anchor="middle" class="title">图3 记忆碎片与冲突治理相关数据结构关系示意图</text>

  <rect x="80" y="170" width="390" height="290" rx="16" ry="16" class="entity"/>
  <text x="275" y="215" text-anchor="middle" class="name">301 记忆碎片 Fragment</text>
  <text x="115" y="260" class="field">- fragment_id</text>
  <text x="115" y="292" class="field">- content</text>
  <text x="115" y="324" class="field">- source_agent</text>
  <text x="115" y="356" class="field">- timestamp</text>
  <text x="115" y="388" class="field">- slot_values</text>
  <text x="115" y="420" class="field">- embedding_ref</text>

  <rect x="650" y="130" width="420" height="360" rx="16" ry="16" class="entity2"/>
  <text x="860" y="175" text-anchor="middle" class="name">302 语义簇 Cluster</text>
  <text x="685" y="220" class="field">- cluster_id</text>
  <text x="685" y="252" class="field">- topic_label</text>
  <text x="685" y="284" class="field">- member_fragment_ids[]</text>
  <text x="685" y="316" class="field">- summary_text</text>
  <text x="685" y="348" class="field">- conflict_priority</text>
  <text x="685" y="380" class="field">- detail_budget</text>
  <text x="685" y="412" class="field">- updated_at</text>

  <rect x="1210" y="170" width="410" height="290" rx="16" ry="16" class="entity"/>
  <text x="1415" y="215" text-anchor="middle" class="name">303 冲突记录 ConflictRecord</text>
  <text x="1245" y="260" class="field">- conflict_id</text>
  <text x="1245" y="292" class="field">- cluster_id</text>
  <text x="1245" y="324" class="field">- slot_name</text>
  <text x="1245" y="356" class="field">- conflicting_values[]</text>
  <text x="1245" y="388" class="field">- evidence_counts</text>
  <text x="1245" y="420" class="field">- dominant_value</text>

  <rect x="240" y="610" width="430" height="260" rx="16" ry="16" class="entity"/>
  <text x="455" y="655" text-anchor="middle" class="name">304 偏好策略 Preference</text>
  <text x="275" y="700" class="field">- category_strength</text>
  <text x="275" y="732" class="field">- source_weights</text>
  <text x="275" y="764" class="field">- time_decay</text>
  <text x="275" y="796" class="field">- budget_clamp_range</text>
  <text x="275" y="828" class="field">- version</text>

  <rect x="920" y="610" width="470" height="260" rx="16" ry="16" class="entity"/>
  <text x="1155" y="655" text-anchor="middle" class="name">305 回溯索引 Backrefs</text>
  <text x="955" y="700" class="field">- index_id</text>
  <text x="955" y="732" class="field">- cluster_id</text>
  <text x="955" y="764" class="field">- summary_span -> fragment_ids[]</text>
  <text x="955" y="796" class="field">- evidence_locator</text>
  <text x="955" y="828" class="field">- retrieval_score</text>

  <path d="M470 300 L650 300" class="edge" marker-end="url(#arrow)"/>
  <text x="550" y="282" text-anchor="middle" class="card">N:1</text>

  <path d="M1070 300 L1210 300" class="edge" marker-end="url(#arrow)"/>
  <text x="1140" y="282" text-anchor="middle" class="card">1:N</text>

  <path d="M455 610 L730 490" class="edgeD" marker-end="url(#arrow)"/>
  <text x="590" y="560" text-anchor="middle" class="card">策略控制</text>

  <path d="M1070 490 L1155 610" class="edge" marker-end="url(#arrow)"/>
  <text x="1105" y="560" text-anchor="middle" class="card">摘要映射</text>

  <path d="M310 460 L980 610" class="edgeD" marker-end="url(#arrow)"/>
  <text x="640" y="560" text-anchor="middle" class="card">证据回溯链</text>
</svg>

